filter( variable == 'ORP mV') %>%
filter(year == 2021) %>%
rename( "Site" = `Site Name`) %>%
mutate( Site = factor(Site)) %>%
na.omit()
anv_spcond <- aov(value ~ Site + month, data = anv_spcond)
summary(anv_spcond)
# NitraLED mg/L anova test
anv_nitra <- all_data %>%
filter( variable == 'ORP mV') %>%
filter(year == 2021) %>%
rename( "Site" = `Site Name`) %>%
mutate( Site = factor(Site)) %>%
na.omit()
anv_nitra <- aov(value ~ Site + month, data = anv_nitra)
summary(anv_nitra)
# Water temp anova test
anv_temp_c <- all_data %>%
filter( variable == 'Temp °C') %>%
filter(year == 2021) %>%
filter(value != 'SENSOR FAILURE') %>%
rename( "Site" = `Site Name`) %>%
mutate( Site = factor(Site)) %>%
na.omit()
anv_temp_c <- aov(value ~ Site + month, data = anv_temp_c)
summary(anv_temp_c)
# NH4+ -N mg/L Anova Test
anv_nh4 <- all_data %>%
filter( variable == 'NH4+ -N mg/L') %>%
filter(year == 2021) %>%
filter(value != 'SENSOR FAILURE') %>%
rename( "Site" = `Site Name`) %>%
mutate( Site = factor(Site)) %>%
na.omit()
anv_nh4 <- aov(value ~ month, data = anv_nh4)
summary(anv_nh4)
# NH3 mg/L anova test
anv_nh3 <- all_data %>%
filter( variable == 'NH3 mg/L') %>%
filter(year == 2021) %>%
filter(value != 'SENSOR FAILURE') %>%
rename( "Site" = `Site Name`) %>%
mutate( Site = factor(Site)) %>%
na.omit()
anv_nh3 <- aov(value ~ month, data =anv_nh3)
summary(anv_nh3)
# select what ya need
sud_hourly<- sud_hourly %>%
select(Timestamp, `VPD Avg (Kpa)`, `Rain (mm)`, `Solar Total (MJ/m²)`)
###################################################3
url5 <- "https://docs.google.com/spreadsheets/d/14nn7NWMBatbzcz9nqcTFzQghmzMUE2o0/edit#gid=571749034"
sud_hourly<-gsheet2tbl(url5)
# number of missing data
errors <- all_data %>%
filter(value == 'SENSOR FAILURE') %>%
filter(year == 2021) %>%
group_by(variable, month) %>%
tally()
# plot of missing data
ggplot(data = errors, aes( x = variable, y = n))+
geom_col()+
facet_wrap(~month)
#####################################################
url5 <- "https://docs.google.com/spreadsheets/d/14nn7NWMBatbzcz9nqcTFzQghmzMUE2o0/edit#gid=571749034"
sud_hourly<-gsheet2tbl(url5)
# select what ya need
sud_hourly<- sud_hourly %>%
select(Timestamp, `VPD Avg (Kpa)`, `Rain (mm)`, `Solar Total (MJ/m²)`)
# make a year column
sudhour<- sudhourly %>%
mutate(yyyy = year(mdy_hm(Timestamp)))
# select what ya need
sud_hourly<- sud_hourly %>%
select(Timestamp, `VPD Avg (Kpa)`, `Rain (mm)`, `Solar Total (MJ/m²)`)
# make a year column
sudhour<- sud_hourly %>%
mutate(yyyy = year(mdy_hm(Timestamp)))
bads <- which(is.na(sudhour$yyyy))
sudhour$yyyy[bads]<-year(ymd_hms(sudhour$Timestamp[bads]))
sudhour[bads,]
# month column
sudhour <- sudhour %>%
mutate(mm = month(mdy_hm(Timestamp)))
bads2 <- which(is.na(sudhour$mm))
sudhour$mm[bads2]<-month(ymd_hms(sudhour$Timestamp[bads2]))
sudhour[bads2,]
# sud VPD avg
avg_vpd<- sudhour %>%
mutate(Month = factor(mm,
levels = c('Jan', 'Feb',
'Mar',
'Apr',
'May', 'Jun',
'Jul', 'Aug', 'Sep',
'Oct', 'Nov', 'Dec'))) %>%
filter(yyyy == 2021) %>%
group_by(mm) %>%
summarise(vpdavg = mean(`VPD Avg (Kpa)`))
# plot of average VPD
ggplot(data = avg_vpd, aes( x = mm, y = vpdavg))+
geom_col(fill = 'aquamarine3')+
scale_x_continuous(
breaks = seq_along(month.name),
labels = month.name)+
theme(axis.text.x = element_text(angle = 90))+
ylim(0,.8)+
labs(title = "VPD Average per Month (2021)",
subtitle = 'At Sewanee Utility District',
y = 'Average VPD (Kpa)',
x = 'Months')
# solar total
avg_solar <- sudhour%>%
filter(yyyy == 2021) %>%
group_by(mm) %>%
summarise(solar_avg = mean(`Solar Total (MJ/m²)`))
# solar total
avg_solar <- sudhour%>%
filter(yyyy == 2021) %>%
group_by(mm) %>%
summarise(avgsolar = mean(`Solar Total (MJ/m²)`))
# graph of average solar total
ggplot(data = avg_solar, aes(x = mm, y = avgsolar)) +
geom_col(fill = 'yellow3')+
scale_x_continuous(
breaks = seq_along(month.name),
labels = month.name)+
theme(axis.text.x = element_text(angle = 90))+
labs(title = "Solar Total Average per Month (2021)",
subtitle = 'At Sewanee Utility District',
y = 'Solar Total (MJ/m2)',
x = 'Months')
# SUD rain avg
avg_rain <-  sudhour2 %>%
filter(yyyy == 2021) %>%
group_by(mm) %>%
summarise(avgrain = mean(`Rain (mm)`))
# SUD rain avg
avg_rain <-  sudhour %>%
filter(yyyy == 2021) %>%
group_by(mm) %>%
summarise(avgrain = mean(`Rain (mm)`))
#  SUD average rainfall
ggplot(data = avg_rain, aes(x = mm, y = avgrain))+
scale_x_continuous(
breaks = seq_along(month.name),
labels = month.name)+
theme(axis.text.x = element_text(angle = 90))+
ylim(0,.15)+
geom_col(fill = 'darkolivegreen3')+
labs(title = "Rainfall per Month (2021)",
subtitle = 'Average Rainfall at Sewanee Utility District',
y = 'Average Rainfall (mm)',
x = 'Months')
library(tidyverse)
library(gsheet)
library(lubridate)
library(data.table)
library(readxl)
library(ggpubr)
library(broom)
library(AICcmodavg)
library(dplyr)
url<-"https://docs.google.com/spreadsheets/d/14nn7NWMBatbzcz9nqcTFzQghmzMUE2o0/edit?usp=sharing&ouid=104854259661631892531&rtpof=true&sd=true"
sud <-gsheet2tbl(url)
url4 <-"https://docs.google.com/spreadsheets/d/1A_ljZAZmiRBsW5iL40EGRlVG1LkMa_w_7rqCnwAFWKA/edit#gid=537305485"
rainfalldf<-gsheet2tbl(url4)
# rename
sud<-sud%>%
rename(Date = `Date Values Reflect`)
# filter missing data
sud<-sud %>%
filter(Date != "MISSING DATA" | Date != "NO POWER - AERATOR INSTALL")
# change date
library(lubridate)
sud2 <- sud
sud2$Date <- mdy(sud$Date)
# month column
sud<-sud2%>%
mutate(month = month(Date))%>%
mutate(month = month.name[month])%>%
mutate(year = year(Date))
# select the needed columns in Sud data
sud3 <- sud2 %>%
select(Date, `Timestamp*`, `Air temp Avg (C)`, `Air Temp Max (C)`,`Air Temp Min`, `Solar Total (MJ/m²)`)
# rename variables
sud3<-sud3 %>% rename(Dates=Date) %>% rename(Time=`Timestamp*`) %>%
rename(air_temp_avg_C = `Air temp Avg (C)`) %>% rename(air_temp_max_C = `Air Temp Max (C)`) %>%
rename(air_temp_min_C = `Air Temp Min`)
# year and month columnns
sud3 <- sud3 %>%
mutate(year = year(Dates))
sud3 <- sud3 %>%
mutate(months = month(Dates))
# avg air temp           ###### NO
avgC <- sud3 %>%
filter(year == 2021) %>%
filter(air_temp_avg_C >= 0) %>%
group_by(months) %>%
summarise(avgC = mean(air_temp_avg_C)) %>%
mutate(months = recode_factor(.x = months,
"1" = 'January',
"2" = 'February',
"3" = 'March',
"4" = 'April',
"5" = 'May',
"6" = 'June',
"7" = 'July',
"8" = 'August',
"9" = 'September',
"10" = 'October',
"11" = 'November',
"12" = 'December'))
# avg air temp           ###### NO
avg_airtemp <- sud3 %>%
filter(year == 2021) %>%
filter(air_temp_avg_C >= 0) %>%
group_by(months) %>%
summarise(avgC = mean(air_temp_avg_C)) %>%
mutate(months = recode_factor(.x = months,
"1" = 'January',
"2" = 'February',
"3" = 'March',
"4" = 'April',
"5" = 'May',
"6" = 'June',
"7" = 'July',
"8" = 'August',
"9" = 'September',
"10" = 'October',
"11" = 'November',
"12" = 'December'))
# average air temperature graph ######### NO
ggplot(data = avg_airtemp, aes(x = months, y = avgC))+
geom_point(color = 'blue')+
geom_line(group=1, color = 'blue')+
theme(axis.text.x  = element_text(angle = 90))+
labs(title = 'Average Air Temperature 2021',
subtitle= 'Air Temperature in Celsius by Month',
y = 'Average Air Temperature (C)',
x = 'Months')
# average Solar Total per month  ######## YES
avg_Solartotal <- sud3 %>%
filter(year == 2021) %>%
filter(`Solar Total (MJ/m²)` >= 0) %>%
group_by(months) %>%
summarise(avgSolar = mean(`Solar Total (MJ/m²)`)) %>%
mutate(months = recode_factor(.x = months,
"1" = 'January',
"2" = 'February',
"3" = 'March',
"4" = 'April',
"5" = 'May',
"6" = 'June',
"7" = 'July',
"8" = 'August',
"9" = 'September',
"10" = 'October',
"11" = 'November',
"12" = 'December'))
# average solar total ##### YES
ggplot()+
geom_col(data = avg_Solartotal, aes(x = months, y = avgSolar), fill = 'gold')+
theme(axis.text.x  = element_text(angle = 90))+
labs(title = 'Average Solar Total 2021',
subtitle= 'In (MJ/m2) per Month',
y = 'Average Solar Total (MJ/m2)',
x = 'Months')
# OESS Precipitation and Temp data  ####3 YES ALL OF THIS?
rainfalldf1 <- rainfalldf
# month collumn
rainfalldf1 <- rainfalldf %>%
filter(!is.na(Date)) %>%
unite( col=Date, Year:Date, sep="-")
#reformat datasets because date was not matche up with the year
rainfalldf1 <-rainfalldf1 %>%
mutate(dates = c(rainfalldf1$Date[1:369] %>% ydm(), rainfalldf1$Date[370:376] %>% ymd())) %>%
mutate( Month = month.abb[month( as_date(dates)) ] )
# select the columns needed
rainfalldf1 <- rainfalldf1 %>%
select(dates, Date, Month, `High temp (F)`, `Low temp (F)`, `rainfall (inches)`)
# avg max temp per month          # YES
tempmax <- rainfalldf1 %>%
mutate(Month = factor(Month,
levels = c('Jan', 'Feb',
'Mar',
'Apr',
'May', 'Jun',
'Jul', 'Aug', 'Sep',
'Oct', 'Nov', 'Dec'))) %>%
group_by(Month) %>%
filter(year(dates) == 2021) %>%
summarise(tempmax = mean(`High temp (F)`))
# avg min temperature per month  # YES
tempmin <- rainfalldf1 %>%
mutate(Month = factor(Month,
levels = c('Jan', 'Feb',
'Mar',
'Apr',
'May', 'Jun',
'Jul', 'Aug', 'Sep',
'Oct', 'Nov', 'Dec'))) %>%
group_by(Month) %>%
filter(year(dates) == 2021) %>%
summarise(tempmin = mean(`Low temp (F)`))
# average temperature plot min/max # YES
ggplot()+
geom_col(data = tempmax, aes(x = Month, y = tempmax), fill= 'blue')+
geom_col(data = tempmin, aes(x = Month, y = tempmin), fill = 'red')+
theme(axis.text.x = element_text(angle = 90))+
labs(title = 'Highest and Lowest Temperatures (2021)',
subtitle = 'Average Temperature (C) per Month ',
y = 'Average Temperature',
x = 'Months')
# total rainfall per month     # YES
oess_totalrain <- rainfalldf1 %>%
mutate(Month = factor(Month,
levels = c('Jan', 'Feb',
'Mar',
'Apr',
'May', 'Jun',
'Jul', 'Aug', 'Sep',
'Oct', 'Nov', 'Dec'))) %>%
group_by(Month) %>%
filter(year(dates)==2021) %>%
summarise(totalrain = sum(na.rm = TRUE,(`rainfall (inches)`)))
# total rainfall plot      # YES
ggplot()+
geom_col(data = oess_totalrain, aes( x= Month, y = totalrain),fill  = 'skyblue1')+
labs(title = 'TotalRainfall (2021)',
subtitle = 'Total Rainfall (in) per Month ',
y = 'Total Rainfall (in)',
x = 'Months')
rainfalldf1 <- rainfalldf1 %>% rename(rainfall = `rainfall (inches)`)
# avg rainfall per month       YES
oess_avgrain <- rainfalldf1 %>%
mutate(Month = factor(Month,
levels = c('Jan', 'Feb',
'Mar',
'Apr',
'May', 'Jun',
'Jul', 'Aug', 'Sep',
'Oct', 'Nov', 'Dec'))) %>%
group_by(Month) %>%
filter(year(dates)==2021) %>%
summarise(avgrain = mean(na.rm = TRUE,(`rainfall (inches)`)))
# avg rainfall per month       YES
oess_avgrain <- rainfalldf1 %>%
mutate(Month = factor(Month,
levels = c('Jan', 'Feb',
'Mar',
'Apr',
'May', 'Jun',
'Jul', 'Aug', 'Sep',
'Oct', 'Nov', 'Dec'))) %>%
group_by(Month) %>%
filter(year(dates)==2021) %>%
summarise(avgrain = mean(na.rm = TRUE,(rainfall)))
View(oess_avgrain)
# average rainfall per month plot with SD
ggplot()+
geom_col(data =mean_sdrain, aes(x = Month, y = mean),
fill = 'blue', group = 1)+
geom_errorbar(data = mean_sdrain, aes(x = Month, ymax = mean+sd, width = .1, ymin = mean))+
labs(title = 'Average Rainfall (2021)',
subtitle = 'Average Rainfall (in) per Month ',
y = 'Average Rainfall (in)',
x = 'Months')
# mean/sd/upper/lower for average rainfall
mean_sdrain <- rainfalldf1 %>%
mutate(Month = factor(Month,
levels = c('Jan', 'Feb',
'Mar',
'Apr',
'May', 'Jun',
'Jul', 'Aug', 'Sep',
'Oct', 'Nov', 'Dec'))) %>%
group_by(Month) %>%
summarise(mean = mean(rainfall, na.rm = TRUE), sd = sd(rainfall, na.rm = TRUE)) %>%
mutate(lower = mean-sd, upper = mean+sd)
# mean/sd plot for rainfall
ggplot()+
geom_col(data =mean_sdrain, aes(x = Month, y = mean),
fill = 'blue', group = 1)+
geom_errorbar(data = mean_sdrain, aes(x = Month, ymax = mean+sd, width = .1, ymin = mean))+
labs(title = 'Average Rainfall (2021)',
subtitle = 'Average Rainfall (in) per Month ',
y = 'Average Rainfall (in)',
x = 'Months')
meansd_tempmax <- rainfalldf1 %>%
mutate(Month = factor(Month,
levels = c('Jan', 'Feb',
'Mar',
'Apr',
'May', 'Jun',
'Jul', 'Aug', 'Sep',
'Oct', 'Nov', 'Dec'))) %>%
group_by(Month) %>%
summarise(mean = mean(`High temp (F)`, na.rm = TRUE), sd = sd(`High temp (F)`, na.rm = TRUE)) %>%
mutate(lower = mean-sd, upper = mean+sd)
# plot of temp max
ggplot()+
geom_col(data =meansd_tempmax, aes(x = Month, y = mean),
fill = 'blue', group = 1)+
geom_errorbar(data = meansd_tempmax, aes(x = Month, ymax = mean+sd, width = .1, ymin = mean))+
labs(title = 'Temperature Max (2021)',
subtitle = 'Temp Max (C) per Month ',
y = 'Average Temperature (C)',
x = 'Months')
meansd_tempmin <- rainfalldf1 %>%
mutate(Month = factor(Month,
levels = c('Jan', 'Feb',
'Mar',
'Apr',
'May', 'Jun',
'Jul', 'Aug', 'Sep',
'Oct', 'Nov', 'Dec'))) %>%
group_by(Month) %>%
summarise(mean = mean(`Low temp (F)`, na.rm = TRUE), sd = sd(`Low temp (F)`, na.rm = TRUE)) %>%
mutate(lower = mean-sd, upper = mean+sd)
# plot of temp min
ggplot()+
geom_col(data =meansd_tempmin, aes(x = Month, y = mean),
fill = 'aquamarine3', group = 1)+
geom_errorbar(data = meansd_tempmin, aes(x = Month, ymax = mean+sd, width = .1, ymin = mean))+
labs(title = 'Temperature Min (2021)',
subtitle = 'Temp Min (C) per Month ',
y = 'Average Min Temperature (C)',
x = 'Months')
# rainfall anova test
rain_df <- aov(rainfall ~ Month, data = rainfalldf1)
# temp max anova test
anv_tmax <- aov(`High temp (F)`~ Month, data = rainfalldf1)
summary(anv_rainfall)
# rainfall anova test
anv_rainfall <- aov(rainfall ~ Month, data = rainfalldf1)
summary(anv_rainfall)
# temp max anova test
anv_tmax <- aov(`High temp (F)`~ Month, data = rainfalldf1)
summary(anv_tmax)
# temp min anova test
anv_tmin <- aov(`Low temp (F)`~ Month, data = rainfalldf1)
summary(anv_tmin)
View(mean_sdrain)
oess_rain <- mean_sdrain %>%
select(mean, Month)
# rainfall in SUD and OESS
ggplot()+
geom_col(data = oessrain, aes(x = Month, y = mean), fill = 'red')+
geom_col(data = rain_avg, aes( x = mm, y = rain_avg), fill = 'blue')+
labs(title = 'Average Rainfall per Month (2021)',
subtitle = 'Sewanee Utility District vs. OESS',
y = 'Average Rain (mm)',
x = 'Month')+
theme(axis.text.x = element_text(angle = 90))
# rainfall in SUD and OESS
ggplot()+
geom_col(data = oess_rain, aes(x = Month, y = mean), fill = 'red')+
geom_col(data = rain_avg, aes( x = mm, y = rain_avg), fill = 'blue')+
labs(title = 'Average Rainfall per Month (2021)',
subtitle = 'Sewanee Utility District vs. OESS',
y = 'Average Rain (mm)',
x = 'Month')+
theme(axis.text.x = element_text(angle = 90))
View(oess_rain)
View(oess_avgrain)
View(oess_rain)
View(oess_avgrain)
View(oess_avgrain)
View(avg_rain)
# rainfall in SUD and OESS
ggplot()+
geom_col(data = oess_rain, aes(x = Month, y = mean), fill = 'red')+
geom_col(data = rain_avg, aes( x = mm, y = avg_rain), fill = 'blue')+
labs(title = 'Average Rainfall per Month (2021)',
subtitle = 'Sewanee Utility District vs. OESS',
y = 'Average Rain (mm)',
x = 'Month')+
theme(axis.text.x = element_text(angle = 90))
# rainfall in SUD and OESS
ggplot()+
geom_col(data = oess_rain, aes(x = Month, y = mean), fill = 'red')+
geom_col(data = avg_rain, aes( x = mm, y = avg_rain), fill = 'blue')+
labs(title = 'Average Rainfall per Month (2021)',
subtitle = 'Sewanee Utility District vs. OESS',
y = 'Average Rain (mm)',
x = 'Month')+
theme(axis.text.x = element_text(angle = 90))
# rainfall in SUD and OESS
ggplot()+
geom_col(data = oess_rain, aes(x = Month, y = mean), fill = 'red')+
geom_col(data = avg_rain, aes( x = mm, y = avgrain), fill = 'blue')+
labs(title = 'Average Rainfall per Month (2021)',
subtitle = 'Sewanee Utility District vs. OESS',
y = 'Average Rain (mm)',
x = 'Month')+
theme(axis.text.x = element_text(angle = 90))
all_data %>%
filter(`Site Name` == 'Lagoon C') %>%
filter(variable == 'Cond µS/cm') %>%
tally()
all_data %>%
filter(`Site Name` == 'Wetland Basin 3') %>%
filter(variable == 'Cond µS/cm' ) %>%
tally()
dfdelta <- all_data %>%
select(month, `Time (HH:mm:ss)`, variable, `Site Name`, value, year, Date) %>%
group_by( `Time (HH:mm:ss)` ) %>%
mutate(condbasin =
dfdelta[dfdelta$`Time (HH:mm:ss)` == `Time (HH:mm:ss)`
&dfdelta$variable == 'Cond µS/cm'
&dfdelta$`Site Name` == 'Wetland Basin 3'
&dfdelta$Date == Date]$value[1])
