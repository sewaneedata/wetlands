filter(year == 2021) %>%
group_by(variable, month) %>%
filter(variable == 'Turbidity NTU') %>%
summarise(meandelta= mean(delta, na.rm = TRUE)) %>%
mutate(Month = factor(month,
levels = c(
'January', 'February', 'March' ,'April',
'May', 'June', 'July', 'August', 'September',
'October', 'November', 'December')))
ggplot(data = deltatotal, aes(x = Month, y = meandelta))+
geom_col(color = 'red')+
theme(axis.text.x = element_text(angle = 90))
oess_rain <- mean_sdrain %>%
select(mean, Month)
library(tidyverse)
library(gsheet)
library(lubridate)
library(data.table)
library(readxl)
library(ggpubr)
library(broom)
library(AICcmodavg)
library(dplyr)
url<-"https://docs.google.com/spreadsheets/d/14nn7NWMBatbzcz9nqcTFzQghmzMUE2o0/edit?usp=sharing&ouid=104854259661631892531&rtpof=true&sd=true"
sud <-gsheet2tbl(url)
url4 <-"https://docs.google.com/spreadsheets/d/1A_ljZAZmiRBsW5iL40EGRlVG1LkMa_w_7rqCnwAFWKA/edit#gid=537305485"
oess_data<-gsheet2tbl(url4)
# rename
sud<-sud%>%
rename(Date = `Date Values Reflect`)
# filter missing data
sud<-sud %>%
filter(Date != "MISSING DATA" | Date != "NO POWER - AERATOR INSTALL")
# change date
library(lubridate)
sud2 <- sud
sud2$Date <- mdy(sud$Date)
# month column
sud<-sud2%>%
mutate(month = month(Date))%>%
mutate(month = month.name[month])%>%
mutate(year = year(Date))
# select the needed columns in Sud data
sud3 <- sud2 %>%
select(Date, `Timestamp*`, `Air temp Avg (C)`, `Air Temp Max (C)`,`Air Temp Min`, `Solar Total (MJ/m²)`)
# rename variables
sud3<-sud3 %>% rename(Dates=Date) %>% rename(Time=`Timestamp*`) %>%
rename(air_temp_avg_C = `Air temp Avg (C)`) %>% rename(air_temp_max_C = `Air Temp Max (C)`) %>%
rename(air_temp_min_C = `Air Temp Min`)
# year and month columnns
sud3 <- sud3 %>%
mutate(year = year(Dates))
sud3 <- sud3 %>%
mutate(months = month(Dates))
# avg air temp           ###### NO
avg_airtemp <- sud3 %>%
filter(year == 2021) %>%
filter(air_temp_avg_C >= 0) %>%
group_by(months) %>%
summarise(avgC = mean(air_temp_avg_C)) %>%
mutate(months = recode_factor(.x = months,
"1" = 'January',
"2" = 'February',
"3" = 'March',
"4" = 'April',
"5" = 'May',
"6" = 'June',
"7" = 'July',
"8" = 'August',
"9" = 'September',
"10" = 'October',
"11" = 'November',
"12" = 'December'))
# average air temperature graph ######### NO
ggplot(data = avg_airtemp, aes(x = months, y = avgC))+
geom_point(color = 'blue')+
geom_line(group=1, color = 'blue')+
theme(axis.text.x  = element_text(angle = 90))+
labs(title = 'Average Air Temperature 2021',
subtitle= 'Air Temperature in Celsius by Month',
y = 'Average Air Temperature (C)',
x = 'Months')
# average Solar Total per month  ######## YES
avg_Solartotal <- sud3 %>%
filter(year == 2021) %>%
filter(`Solar Total (MJ/m²)` >= 0) %>%
group_by(months) %>%
summarise(avgSolar = mean(`Solar Total (MJ/m²)`)) %>%
mutate(months = recode_factor(.x = months,
"1" = 'January',
"2" = 'February',
"3" = 'March',
"4" = 'April',
"5" = 'May',
"6" = 'June',
"7" = 'July',
"8" = 'August',
"9" = 'September',
"10" = 'October',
"11" = 'November',
"12" = 'December'))
# average solar total ##### YES
ggplot()+
geom_col(data = avg_Solartotal, aes(x = months, y = avgSolar), fill = 'gold')+
theme(axis.text.x  = element_text(angle = 90))+
labs(title = 'Average Solar Total 2021',
subtitle= 'In (MJ/m2) per Month',
y = 'Average Solar Total (MJ/m2)',
x = 'Months')
# OESS Precipitation and Temp data  ####3 YES ALL OF THIS?
oess_data2 <- oess_data
# month collumn
oess_data2 <- oess_data %>%
filter(!is.na(Date)) %>%
unite( col=Date, Year:Date, sep="-")
#reformat datasets because date was not matche up with the year
oess_data2<-oess_data2 %>%
mutate(dates = c(oess_data2$Date[1:369] %>% ydm(), oess_data2$Date[370:376] %>% ymd())) %>%
mutate( Month = month.abb[month( as_date(dates)) ] )
# select the columns needed
oess_data2 <- oess_data2 %>%
select(dates, Date, Month, `High temp (F)`, `Low temp (F)`, `rainfall (inches)`)
# avg max temp per month          # YES
tempmax <- oess_data2 %>%
mutate(Month = factor(Month,
levels = c('Jan', 'Feb',
'Mar',
'Apr',
'May', 'Jun',
'Jul', 'Aug', 'Sep',
'Oct', 'Nov', 'Dec'))) %>%
group_by(Month) %>%
filter(year(dates) == 2021) %>%
summarise(tempmax = mean(`High temp (F)`))
# avg min temperature per month  # YES
tempmin <- oess_data2 %>%
mutate(Month = factor(Month,
levels = c('Jan', 'Feb',
'Mar',
'Apr',
'May', 'Jun',
'Jul', 'Aug', 'Sep',
'Oct', 'Nov', 'Dec'))) %>%
group_by(Month) %>%
filter(year(dates) == 2021) %>%
summarise(tempmin = mean(`Low temp (F)`))
# average temperature plot min/max # YES
ggplot()+
geom_col(data = tempmax, aes(x = Month, y = tempmax), fill= 'blue')+
geom_col(data = tempmin, aes(x = Month, y = tempmin), fill = 'red')+
theme(axis.text.x = element_text(angle = 90))+
labs(title = 'Highest and Lowest Temperatures (2021)',
subtitle = 'Average Temperature (C) per Month ',
y = 'Average Temperature',
x = 'Months')
# total rainfall per month     # YES
oess_totalrain <-oess_data2 %>%
mutate(Month = factor(Month,
levels = c('Jan', 'Feb',
'Mar',
'Apr',
'May', 'Jun',
'Jul', 'Aug', 'Sep',
'Oct', 'Nov', 'Dec'))) %>%
group_by(Month) %>%
filter(year(dates)==2021) %>%
summarise(totalrain = sum(na.rm = TRUE,(`rainfall (inches)`)))
# total rainfall plot      # YES
ggplot()+
geom_col(data = oess_totalrain, aes( x= Month, y = totalrain),fill  = 'skyblue1')+
labs(title = 'TotalRainfall (2021)',
subtitle = 'Total Rainfall (in) per Month ',
y = 'Total Rainfall (in)',
x = 'Months')
oess_data2 <- oess_data2 %>% rename(rainfall = `rainfall (inches)`)
# avg rainfall per month       YES
oess_avgrain <- oess_data2 %>%
mutate(Month = factor(Month,
levels = c('Jan', 'Feb',
'Mar',
'Apr',
'May', 'Jun',
'Jul', 'Aug', 'Sep',
'Oct', 'Nov', 'Dec'))) %>%
group_by(Month) %>%
filter(year(dates)==2021) %>%
summarise(avgrain = mean(na.rm = TRUE,(rainfall)))
# mean/sd/upper/lower for average rainfall
mean_sdrain <- oess_data2 %>%
mutate(Month = factor(Month,
levels = c('Jan', 'Feb',
'Mar',
'Apr',
'May', 'Jun',
'Jul', 'Aug', 'Sep',
'Oct', 'Nov', 'Dec'))) %>%
group_by(Month) %>%
summarise(mean = mean(rainfall, na.rm = TRUE), sd = sd(rainfall, na.rm = TRUE)) %>%
mutate(lower = mean-sd, upper = mean+sd)
# mean/sd plot for rainfall
ggplot()+
geom_col(data =mean_sdrain, aes(x = Month, y = mean),
fill = 'blue', group = 1)+
geom_errorbar(data = mean_sdrain, aes(x = Month, ymax = mean+sd, width = .1, ymin = mean))+
labs(title = 'Average Rainfall (2021)',
subtitle = 'Average Rainfall (in) per Month ',
y = 'Average Rainfall (in)',
x = 'Months')
meansd_tempmax <- oess_data2 %>%
mutate(Month = factor(Month,
levels = c('Jan', 'Feb',
'Mar',
'Apr',
'May', 'Jun',
'Jul', 'Aug', 'Sep',
'Oct', 'Nov', 'Dec'))) %>%
group_by(Month) %>%
summarise(mean = mean(`High temp (F)`, na.rm = TRUE), sd = sd(`High temp (F)`, na.rm = TRUE)) %>%
mutate(lower = mean-sd, upper = mean+sd)
# plot of temp max
ggplot()+
geom_col(data =meansd_tempmax, aes(x = Month, y = mean),
fill = 'blue', group = 1)+
geom_errorbar(data = meansd_tempmax, aes(x = Month, ymax = mean+sd, width = .1, ymin = mean))+
labs(title = 'Temperature Max (2021)',
subtitle = 'Temp Max (C) per Month ',
y = 'Average Temperature (C)',
x = 'Months')
meansd_tempmin <- oess_data2 %>%
mutate(Month = factor(Month,
levels = c('Jan', 'Feb',
'Mar',
'Apr',
'May', 'Jun',
'Jul', 'Aug', 'Sep',
'Oct', 'Nov', 'Dec'))) %>%
group_by(Month) %>%
summarise(mean = mean(`Low temp (F)`, na.rm = TRUE), sd = sd(`Low temp (F)`, na.rm = TRUE)) %>%
mutate(lower = mean-sd, upper = mean+sd)
# plot of temp min
ggplot()+
geom_col(data =meansd_tempmin, aes(x = Month, y = mean),
fill = 'aquamarine3', group = 1)+
geom_errorbar(data = meansd_tempmin, aes(x = Month, ymax = mean+sd, width = .1, ymin = mean))+
labs(title = 'Temperature Min (2021)',
subtitle = 'Temp Min (C) per Month ',
y = 'Average Min Temperature (C)',
x = 'Months')
# rainfall anova test
anv_rainfall <- aov(rainfall ~ Month, data = rainfalldf1)
#####################################################
url5 <- "https://docs.google.com/spreadsheets/d/14nn7NWMBatbzcz9nqcTFzQghmzMUE2o0/edit#gid=571749034"
sud_hourly<-gsheet2tbl(url5)
# select what ya need
sud_hourly<- sud_hourly %>%
select(Timestamp, `VPD Avg (Kpa)`, `Rain (mm)`, `Solar Total (MJ/m²)`)
# make a year column
sudhour<- sud_hourly %>%
mutate(yyyy = year(mdy_hm(Timestamp)))
bads <- which(is.na(sudhour$yyyy))
sudhour$yyyy[bads]<-year(ymd_hms(sudhour$Timestamp[bads]))
sudhour[bads,]
# month column
sudhour <- sudhour %>%
mutate(mm = month(mdy_hm(Timestamp)))
bads2 <- which(is.na(sudhour$mm))
sudhour$mm[bads2]<-month(ymd_hms(sudhour$Timestamp[bads2]))
sudhour[bads2,]
# sud VPD avg
avg_vpd<- sudhour %>%
mutate(Month = factor(mm,
levels = c('Jan', 'Feb',
'Mar',
'Apr',
'May', 'Jun',
'Jul', 'Aug', 'Sep',
'Oct', 'Nov', 'Dec'))) %>%
filter(yyyy == 2021) %>%
group_by(mm) %>%
summarise(vpdavg = mean(`VPD Avg (Kpa)`))
# plot of average VPD
ggplot(data = avg_vpd, aes( x = mm, y = vpdavg))+
geom_col(fill = 'aquamarine3')+
scale_x_continuous(
breaks = seq_along(month.name),
labels = month.name)+
theme(axis.text.x = element_text(angle = 90))+
ylim(0,.8)+
labs(title = "VPD Average per Month (2021)",
subtitle = 'At Sewanee Utility District',
y = 'Average VPD (Kpa)',
x = 'Months')
# solar total
avg_solar <- sudhour%>%
filter(yyyy == 2021) %>%
group_by(mm) %>%
summarise(avgsolar = mean(`Solar Total (MJ/m²)`))
# graph of average solar total
ggplot(data = avg_solar, aes(x = mm, y = avgsolar)) +
geom_col(fill = 'yellow3')+
scale_x_continuous(
breaks = seq_along(month.name),
labels = month.name)+
theme(axis.text.x = element_text(angle = 90))+
labs(title = "Solar Total Average per Month (2021)",
subtitle = 'At Sewanee Utility District',
y = 'Solar Total (MJ/m2)',
x = 'Months')
# SUD rain avg
avg_rain <-  sudhour %>%
filter(yyyy == 2021) %>%
group_by(mm) %>%
summarise(avgrain = mean(`Rain (mm)`))
#  SUD average rainfall
ggplot(data = avg_rain, aes(x = mm, y = avgrain))+
scale_x_continuous(
breaks = seq_along(month.name),
labels = month.name)+
theme(axis.text.x = element_text(angle = 90))+
ylim(0,.15)+
geom_col(fill = 'darkolivegreen3')+
labs(title = "Rainfall per Month (2021)",
subtitle = 'Average Rainfall at Sewanee Utility District',
y = 'Average Rainfall (mm)',
x = 'Months')
oess_rain <- mean_sdrain %>%
select(mean, Month)
# rainfall in SUD and OESS
ggplot()+
geom_col(data = oess_rain, aes(x = Month, y = mean), fill = 'red')+
geom_col(data = avg_rain, aes( x = mm, y = avgrain), fill = 'blue')+
labs(title = 'Average Rainfall per Month (2021)',
subtitle = 'Sewanee Utility District vs. OESS',
y = 'Average Rain (mm)',
x = 'Month')+
theme(axis.text.x = element_text(angle = 90))
ggplot(data = deltatotal, aes(x = Month, y = meandelta))+
geom_col(color = 'red')+
theme(axis.text.x = element_text(angle = 90))
View(all_data2)
View(all_data)
View(all_data)
url4 <-"https://docs.google.com/spreadsheets/d/1A_ljZAZmiRBsW5iL40EGRlVG1LkMa_w_7rqCnwAFWKA/edit#gid=537305485"
oess_data<-gsheet2tbl(url4)
View(oess_data)
oess_rain <- mean_sdrain %>%
select(mean, Month)
View(oess_rain)
View(oess_data2)
View(oess_totalrain)
View(avg_rain)
View(sudhour)
View(sudhour)
sud_totalrain <- sudhour %>%
filter(yyyy == 2021) %>%
group_by(mm) %>%
summarise(totalrain = sum(`Rain (mm)`))
View(sud_totalrain)
View(oess_totalrain)
View(oess_totalrain)
ggplot()+
geom_col(data = oess_totalrain, aes(x = Month, y = totalrain), fill = 'red')+
geom_col(data = sud_totalrain, aes( x = mm, y = totalrain), fill = 'blue')+
labs(title = 'Total Rainfall per Month (2021)',
subtitle = 'Sewanee Utility District vs. OESS',
y = 'Total Rain (mm)',
x = 'Month')+
theme(axis.text.x = element_text(angle = 90))
geom_col(data = oess_totalrain, aes(x = Month, y = totalrain), fill = 'red')+
labs(title = 'Total Rainfall per Month (2021)',
subtitle = 'Sewanee Utility District vs. OESS',
y = 'Total Rain (mm)',
x = 'Month')+
theme(axis.text.x = element_text(angle = 90))
ggplot()+
geom_col(data = sud_totalrain, aes( x = mm, y = totalrain), fill = 'blue')+
geom_col(data = oess_totalrain, aes(x = Month, y = totalrain), fill = 'red')+
labs(title = 'Total Rainfall per Month (2021)',
subtitle = 'Sewanee Utility District vs. OESS',
y = 'Total Rain (mm)',
x = 'Month')+
theme(axis.text.x = element_text(angle = 90))
ggplot()+
geom_col(data = sud_totalrain, aes( x = mm, y = totalrain), fill = 'blue')+
geom_col(data = oess_totalrain, aes(x = Month, y = totalrain), fill = 'red')+
labs(title = 'Total Rainfall per Month (2021)',
subtitle = 'Sewanee Utility District vs. OESS',
y = 'Total Rain (mm)',
x = 'Month')+
theme(axis.text.x = element_text(angle = 90))
ggplot()+
geom_col(data = sud_totalrain, aes( x = mm, y = totalrain), fill = 'blue')
ggplot()+
geom_col(data = sud_totalrain, aes( x = mm, y = totalrain), fill = 'blue')+
geom_col(data = oess_totalrain, aes(x = Month, y = totalrain), fill = 'red')
View(oess_totalrain)
ggplot()+
geom_col(data = sud_totalrain, aes( x = mm, y = totalrain), fill = 'blue')+
geom_col(data = oess_totalrain, aes(x = Month, y = totalrain), fill = 'red')+
labs(title = 'Total Rainfall per Month (2021)',
subtitle = 'Sewanee Utility District vs. OESS',
y = 'Total Rain (mm)',
x = 'Month')+
theme(axis.text.x = element_text(angle = 90))
ggplot()+
geom_col(data = oess_totalrain, aes(x = Month, y = totalrain), fill = 'red')+
geom_col(data = sud_totalrain, aes( x = mm, y = totalrain), fill = 'blue')
ggplot()+
geom_col(data = oess_totalrain, aes(x = Month, y = totalrain), fill = 'red')+
geom_col(data = sud_totalrain, aes( x = mm, y = totalrain), fill = 'blue')+
labs(title = 'Total Rainfall per Month (2021)',
subtitle = 'Sewanee Utility District vs. OESS',
y = 'Total Rain (mm)',
x = 'Month')+
theme(axis.text.x = element_text(angle = 90))
ggplot()+
geom_col(data = oess_totalrain, aes(x = Month, y = totalrain), fill = 'red')+
geom_col(data = sud_totalrain, aes( x = mm, y = totalrain), fill = 'blue')+
position_dodge()+
labs(title = 'Total Rainfall per Month (2021)',
subtitle = 'Sewanee Utility District vs. OESS',
y = 'Total Rain (mm)',
x = 'Month')+
theme(axis.text.x = element_text(angle = 90))
ggplot()+
geom_col(data = oess_totalrain, aes(x = Month, y = totalrain), fill = 'red')+
geom_col(data = sud_totalrain, aes( x = mm, y = totalrain), fill = 'blue')+
geom_col(position = 'dodge2')+
labs(title = 'Total Rainfall per Month (2021)',
subtitle = 'Sewanee Utility District vs. OESS',
y = 'Total Rain (mm)',
x = 'Month')+
theme(axis.text.x = element_text(angle = 90))
ggplot()+
geom_col(data = oess_totalrain, aes(x = Month, y = totalrain), fill = 'red')+
geom_col(data = sud_totalrain, aes( x = mm, y = totalrain), fill = 'blue')+
geom_col(data = oess_totalrain, position = 'dodge2')+
labs(title = 'Total Rainfall per Month (2021)',
subtitle = 'Sewanee Utility District vs. OESS',
y = 'Total Rain (mm)',
x = 'Month')+
theme(axis.text.x = element_text(angle = 90))
ggplot()+
geom_col(data = oess_totalrain, aes(x = Month, y = totalrain), fill = 'red')+
geom_col(data = sud_totalrain, aes( x = mm, y = totalrain), fill = 'blue')+
geom_col(data = oess_totalrain), position = 'dodge2')+
labs(title = 'Total Rainfall per Month (2021)',
subtitle = 'Sewanee Utility District vs. OESS',
y = 'Total Rain (mm)',
x = 'Month')+
theme(axis.text.x = element_text(angle = 90))
ggplot()+
geom_col(data = oess_totalrain, aes(x = Month, y = totalrain), fill = 'red')+
geom_col(data = sud_totalrain, aes( x = mm, y = totalrain), fill = 'blue')+
geom_col(position = 'dodge2')+
labs(title = 'Total Rainfall per Month (2021)',
subtitle = 'Sewanee Utility District vs. OESS',
y = 'Total Rain (mm)',
x = 'Month')+
theme(axis.text.x = element_text(angle = 90))
ggplot()+
geom_col(data = oess_totalrain, aes(x = Month, y = totalrain), fill = 'red')+
geom_col(data = sud_totalrain, aes( x = mm, y = totalrain), fill = 'blue')+
geom_col(position = 'dodge')+
labs(title = 'Total Rainfall per Month (2021)',
subtitle = 'Sewanee Utility District vs. OESS',
y = 'Total Rain (mm)',
x = 'Month')+
theme(axis.text.x = element_text(angle = 90))
ggplot()+
geom_col(data = oess_totalrain, aes(x = Month, y = totalrain), fill = 'red')+
geom_col(data = sud_totalrain, aes( x = mm, y = totalrain), fill = 'blue')+
position = position_dodge2(preserve = "single")
ggplot()+
geom_col(data = oess_totalrain, aes(x = Month, y = totalrain), fill = 'red')+
geom_col(data = sud_totalrain, aes( x = mm, y = totalrain), fill = 'blue')+
position = position_dodge2(preserve = "single")+
labs(title = 'Total Rainfall per Month (2021)',
subtitle = 'Sewanee Utility District vs. OESS',
y = 'Total Rain (mm)',
x = 'Month')+
theme(axis.text.x = element_text(angle = 90))
comparedrain <- cbind(sud_totalrain, oess_totalrain)
View(comparedrain)
ggplot()+
ggplot(data = comparedrain, aes(x = mm, y = totalrain, fill = 'blue')) +
geom_bar(stat = "identity", position = position_dodge(), alpha = 0.75)+
labs(title = 'Total Rainfall per Month (2021)',
subtitle = 'Sewanee Utility District vs. OESS',
y = 'Total Rain (mm)',
x = 'Month')+
theme(axis.text.x = element_text(angle = 90))
View(comparedrain)
View(comparedrain)
colnames( comparedrain ) <- c("mm", "SUD", "Month", "OESS")
comparedrain <- comparedrain %>% select(-mm)
ggplot( comparedrain %>% pivot_longer(!Month), aes(x=Month, y=value, fill=name)) + geom_col(position="dodge")
View(comparedrain %>% pivot_longer(!Month))
comparedrain <- cbind(sud_totalrain, oess_totalrain)
comparedrain <- comparedrain %>% select(-mm)
ggplot( comparedrain %>% pivot_longer(!Month), aes(x=Month, y=value, fill=name)) + geom_col(position="dodge")
ggplot( comparedrain %>% pivot_longer(!Month), aes(x=Month, y=value, fill=name)) +
geom_col(position="dodge")+
View(comparedrain %>% pivot_longer(!Month))
ggplot( comparedrain %>% pivot_longer(!Month), aes(x=Month, y=value, fill=name)) +
geom_col(position="dodge")+
View(comparedrain %>% pivot_longer(!Month))+
labs(title = 'Total Rainfall per Month (2021)',
subtitle = 'Sewanee Utility District vs. OESS',
y = 'Total Rain (mm)',
x = 'Month')+
theme(axis.text.x = element_text(angle = 90))
